echo '##################################'
echo '###       ***FeraLab***        ###'
echo '##################################'
echo ' '
echo ' '
echo '### Applying latest config... ###'
cd
cd ferra
rm -R 0UTPUT
mkdir 0UTPUT
cd kernel
ARCH=arm CROSS_COMPILE=/home/feravolt/ferra/toolchain/bin/arm-cortex_a8-linux-gnueabi- make fera_es209ra_defconfig
echo '### Compiling FeraKernel... ###'
ARCH=arm CROSS_COMPILE=/home/feravolt/ferra/toolchain/bin/arm-cortex_a8-linux-gnueabi- make -j2
cd /home/feravolt/ferra/kernel/drivers/net/wireless/ath6k/
echo '### Cleaning binaries... ###'
/home/feravolt/ferra/toolchain/bin/arm-cortex_a8-linux-gnueabi-strip --strip-unneeded ar6000.ko
cd
echo '### Packing kernel... ###'
if [ -e /home/feravolt/ferra/kerne/arch/arm/boot/zImage ]; then
rm -f /home/feravolt/ferra/kernel/tools/input/zImage
rm -f /home/feravolt/ferra/kernel/tools/input/ramdisk/modules/wifi.ko
cp /home/feravolt/ferra/kernel/arch/arm/boot/zImage /home/feravolt/ferra/kernel/tools/input/zImage
mv /home/feravolt/ferra/kernel/drivers/net/wireless/ath6k/ar6000.ko /home/feravolt/ferra/kernel/tools/input/ramdisk/modules/wifi.ko
cd /home/feravolt/ferra/kernel/tools/ramdisk
./pack
cd
cd /home/feravolt/ferra/kernel/tools/ftf
./build
cd
mv -t /home/feravolt/ferra/0UTPUT /home/feravolt/ferra/kernel/tools/output/*
rm -f /home/feravolt/ferra/kernel/tools/input/zImage
rm -f /home/feravolt/ferra/kernel/tools/input/ramdisk.cpio.gz
rm -f /home/feravolt/ferra/kernel/tools/input/ramdisk/modules/wifi.ko
fi;
echo '### DONE! ###'

