echo '##################################'
echo '###       ***FeraLab***        ###'
echo '##################################'
echo ' '
echo ' '
echo '### Applying latest config... ###'
cd
cd /home/feravolt/ferra
rm -R 0UTPUT
mkdir 0UTPUT
ARCH=arm CROSS_COMPILE=/home/feravolt/ferra/tools/linaro/bin/arm-cortex_a8-linux-gnueabi- make fera_es209ra_defconfig
echo '### Compiling FeraKernel... ###'
ARCH=arm CROSS_COMPILE=/home/feravolt/ferra/tools/linaro/bin/arm-cortex_a8-linux-gnueabi- make -j2
cd /home/feravolt/ferra/drivers/net/wireless/ath6k/
echo '### Cleaning binaries... ###'
/home/feravolt/ferra/tools/linaro/bin/arm-cortex_a8-linux-gnueabi-strip --strip-unneeded ar6000.ko
cd
if [ -e /home/feravolt/ferra/arch/arm/boot/zImage ]; then
rm -f /home/feravolt/ferra/tools/input/zImage
rm -f /home/feravolt/ferra/tools/input/ramdisk-folder/modules/wifi.ko
cp /home/feravolt/ferra/arch/arm/boot/zImage /home/feravolt/ferra/tools/input/zImage
mv /home/feravolt/ferra/drivers/net/wireless/ath6k/ar6000.ko /home/feravolt/ferra/tools/input/ramdisk-folder/modules/wifi.ko
cd /home/feravolt/ferra/tools/edit-ramdisk
./pack
cd
cd /home/feravolt/ferra/tools/edit-kernel/ftf
./build
cd
mv /home/feravolt/ferra/tools/input/ramdisk.cpio.gz /home/feravolt/ferra/tools/input/initrd.img
cd /home/feravolt/ferra/tools/edit-kernel/bootimg
./build
cd
mv -t /home/feravolt/ferra/0UTPUT /home/feravolt/ferra/tools/output/*
rm /home/feravolt/ferra/tools/input/initrd.img
rm /home/feravolt/ferra/tools/input/zImage
fi;
echo '### DONE! ###'

